---
output: github_document 
---
<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-"
)
```

# <img src="https://i.imgur.com/3jITMq8.png" align="right" height=40 /> TODO Add description

<!-- badges: start -->
[![lifecycle](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://www.tidyverse.org/lifecycle/#experimental)
[![CRAN status](https://www.r-pkg.org/badges/version/r2dii.analysis)](https://CRAN.R-project.org/package=r2dii.analysis)
<!-- badges: end -->

The goal of r2dii.analysis is to TODO ...

## Installation

Install the development version of r2dii.analysis with something like this:

```r
# install.packages("devtools")

# To install from a private repo, see ?usethis::browse_github_token()
devtools::install_github("2DegreesInvesting/r2dii.analysis", auth_token = "abc")
```

## Example

We start by using the r2dii.analysis package. We also use dplyr for general purpose manipulation.

```{r example}
library(r2dii.analysis)
library(dplyr)
```

We also use a number of sample datasets:

* `r2dii.analysis::sample_audit` contains data of TODO ...
* `r2dii.analysis::sample_results` contains data of TODO ...
* `r2dii.analysis::tech_sector_weighting` contains data of TODO ...
* `r2dii.analysis::scenario_relationships` contains data of TODO ...

```{r}
glimpse(r2dii.analysis::sample_audit)

glimpse(r2dii.analysis::sample_results)

glimpse(r2dii.analysis::tech_sector_weighting)

glimpse(r2dii.analysis::scenario_relationships)
```

* `single_indicator()` helps you TODO ...

```{r}
out_single_indicator <- single_indicator(
  input_results = r2dii.analysis::sample_results,
  upper_temp_threshold = 10,
  lower_temp_threshold = 1.5,
  start_year = 2019,
  time_horizon = 5,
  allocation = "PortfolioWeight",
  group_vars = c("Investor.Name", "Portfolio.Name", "Asset.Type"),
  # ASK @vintented: Should this be internal data (not used directly by users?)
  scenario_relationships = r2dii.analysis::scenario_relationships
)

out_single_indicator
```

* `influencemap_weighting_methodology()` helps you TODO ...

```{r}
out_influencemap_weighting_methodology <- influencemap_weighting_methodology(
  input_results = out_single_indicator,
  input_audit = r2dii.analysis::sample_audit,
  metric_name = "temperature",
  group_vars = c("Investor.Name", "Portfolio.Name"),
  # ASK @vintented: Should this be internal data (not used directly by users?)
  sector_weightings = r2dii.analysis::tech_sector_weighting
) %>% 
  # ASK @vintented: Should this go into influencemap_weighting_methodology()?
  distinct(Investor.Name, Portfolio.Name, Allocation, temperature)

out_influencemap_weighting_methodology
```

* `mapped_sector_exposure()` helps you TODO ...

```{r}
out_mapped_sector_exposure <- mapped_sector_exposure(
  input_audit = r2dii.analysis::sample_audit
)

out_mapped_sector_exposure
```

We now join `out_influencemap_weighting_methodology` and `out_mapped_sector_exposure` because TODO ...

```{r}
joint <- inner_join(
  out_influencemap_weighting_methodology, out_mapped_sector_exposure, 
  by = c("Investor.Name", "Portfolio.Name")
)
```

* `find_range()` helps you TODO ...

```{r}
find_range(joint, range = c(1.75, 2, 2.75, 3.5))
```



