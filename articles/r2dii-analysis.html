<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to r2dii.analysis • r2dii.analysis</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to r2dii.analysis">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">r2dii.analysis</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/r2dii-analysis.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/target-sda.html">Sectoral Decarbonization Approach (SDA)</a>
    </li>
    <li>
      <a href="../articles/target-market-share.html">Market Share Approach</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="https://2degreesinvesting.github.io/r2dii.data">r2dii.data</a>
    </li>
    <li>
      <a href="https://2degreesinvesting.github.io/r2dii.match">r2dii.match</a>
    </li>
    <li>
      <a href="https://2degreesinvesting.github.io/r2dii.analysis">r2dii.analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/2DegreesInvesting/r2dii.analysis">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="r2dii-analysis_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Introduction to r2dii.analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/2DegreesInvesting/r2dii.analysis/blob/master/vignettes/r2dii-analysis.Rmd"><code>vignettes/r2dii-analysis.Rmd</code></a></small>
      <div class="hidden name"><code>r2dii-analysis.Rmd</code></div>

    </div>

    
    
<div id="load-your-r2dii-libraries" class="section level2">
<h2 class="hasAnchor">
<a href="#load-your-r2dii-libraries" class="anchor"></a>Load your r2dii libraries</h2>
<p>The first step in your analysis will be to load in the recommended r2dii packages into your current R session. <a href="https://2degreesinvesting.github.io/r2dii.data">r2dd.data</a> includes fake data to help demonstrate the tool and <a href="https://2degreesinvesting.github.io/r2dii.match">r2dd.match</a> provides functions to help you easily match your loanbook to asset-level data.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(r2dii.data)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(r2dii.match)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(r2dii.analysis)</span></code></pre></div>
<p>we also recommend the following two <code>tidyverse</code> packages for data manipulation and plotting:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(dplyr)</span></code></pre></div>
<pre><code>## 
## Attaching package: 'dplyr'</code></pre>
<pre><code>## The following objects are masked from 'package:stats':
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(ggplot2)</span></code></pre></div>
</div>
<div id="match-your-loanbook-to-climate-related-asset-level-data" class="section level2">
<h2 class="hasAnchor">
<a href="#match-your-loanbook-to-climate-related-asset-level-data" class="anchor"></a>Match your loanbook to climate-related asset-level data</h2>
<p>See <a href="https://2degreesinvesting.github.io/r2dii.match">r2dd.match</a> for a more complete description of this process.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>matched &lt;-<span class="st"> </span><span class="kw"><a href="https://github.com/2DegreesInvesting/r2dii.match//reference/match_name.html">match_name</a></span>(</span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="dt">loanbook =</span> loanbook_demo, </span>
<span id="cb7-3"><a href="#cb7-3"></a>  <span class="dt">ald =</span> ald_demo,</span>
<span id="cb7-4"><a href="#cb7-4"></a>  <span class="dt">overwrite =</span> overwrite_demo</span>
<span id="cb7-5"><a href="#cb7-5"></a>  ) <span class="op">%&gt;%</span></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="st">  </span><span class="kw"><a href="https://github.com/2DegreesInvesting/r2dii.match//reference/prioritize.html">prioritize</a></span>()</span></code></pre></div>
<pre><code>## Warning: You should only overwrite a sector at the level of the 'direct
## loantaker' (DL). If you overwrite a sector at the level of the 'ultimate
## parent' (UP) you consequently overwrite all children of that sector,
## which most likely is a mistake.</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>matched <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 x 27
##   id_loan id_direct_loant… name_direct_loa… id_intermediate… name_intermedia…
##   &lt;chr&gt;   &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;            &lt;chr&gt;           
## 1 L151    C168             Shaanxi Auto     &lt;NA&gt;             &lt;NA&gt;            
## 2 L152    C169             Shandong Auto    &lt;NA&gt;             &lt;NA&gt;            
## 3 L153    C170             Shandong Kama    &lt;NA&gt;             &lt;NA&gt;            
## 4 L154    C171             Shandong Tangju… &lt;NA&gt;             &lt;NA&gt;            
## 5 L155    C173             Shanghai Automo… &lt;NA&gt;             &lt;NA&gt;            
## 6 L156    C176             Shanxi Dayun     &lt;NA&gt;             &lt;NA&gt;            
## # … with 22 more variables: id_ultimate_parent &lt;chr&gt;,
## #   name_ultimate_parent &lt;chr&gt;, loan_size_outstanding &lt;dbl&gt;,
## #   loan_size_outstanding_currency &lt;chr&gt;, loan_size_credit_limit &lt;dbl&gt;,
## #   loan_size_credit_limit_currency &lt;chr&gt;, sector_classification_system &lt;chr&gt;,
## #   sector_classification_input_type &lt;chr&gt;,
## #   sector_classification_direct_loantaker &lt;dbl&gt;, fi_type &lt;chr&gt;,
## #   flag_project_finance_loan &lt;chr&gt;, name_project &lt;lgl&gt;,
## #   lei_direct_loantaker &lt;lgl&gt;, isin_direct_loantaker &lt;lgl&gt;, id_2dii &lt;chr&gt;,
## #   level &lt;chr&gt;, sector &lt;chr&gt;, sector_ald &lt;chr&gt;, name &lt;chr&gt;, name_ald &lt;chr&gt;,
## #   score &lt;dbl&gt;, source &lt;chr&gt;</code></pre>
</div>
<div id="calculate-targets" class="section level2">
<h2 class="hasAnchor">
<a href="#calculate-targets" class="anchor"></a>Calculate targets</h2>
<p>You can calculate scenario targets using two different approaches.</p>
<div id="market-share-approach" class="section level3">
<h3 class="hasAnchor">
<a href="#market-share-approach" class="anchor"></a>Market Share Approach</h3>
<p>The <a href="articles/target-market-share.html">Market Share Approach</a> is used to calculate scenario targets for the <code>production</code> of a technology in a sector. For example, we can use this approach to set targets for the production of electric vehicles in the automotive sector. This approach is recommended for sectors where a granular technology scenario roadmap exists.</p>
<p>Targets can be set at the portfolio level:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>market_share_targets_portfolio &lt;-<span class="st"> </span>matched <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="st">  </span><span class="kw"><a href="../reference/target_market_share.html">target_market_share</a></span>(</span>
<span id="cb11-3"><a href="#cb11-3"></a>    <span class="dt">ald =</span> ald_demo, </span>
<span id="cb11-4"><a href="#cb11-4"></a>    <span class="dt">scenario =</span> scenario_demo_<span class="dv">2020</span>,</span>
<span id="cb11-5"><a href="#cb11-5"></a>    <span class="dt">region_isos =</span> region_isos_demo</span>
<span id="cb11-6"><a href="#cb11-6"></a>    )</span>
<span id="cb11-7"><a href="#cb11-7"></a></span>
<span id="cb11-8"><a href="#cb11-8"></a>market_share_targets_portfolio <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 x 7
##   sector technology  year region scenario_source weighted_produc…
##   &lt;chr&gt;  &lt;chr&gt;      &lt;int&gt; &lt;chr&gt;  &lt;chr&gt;           &lt;chr&gt;           
## 1 autom… electric    2020 global demo_2020       projected       
## 2 autom… electric    2020 global demo_2020       normalized_corp…
## 3 autom… electric    2020 global demo_2020       target_cps      
## 4 autom… electric    2020 global demo_2020       target_sds      
## 5 autom… electric    2020 global demo_2020       target_sps      
## 6 autom… hybrid      2020 global demo_2020       projected       
## # … with 1 more variable: weighted_production_value &lt;dbl&gt;</code></pre>
<p>… or at the company level:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>market_share_targets_company &lt;-<span class="st"> </span>matched <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="st">  </span><span class="kw"><a href="../reference/target_market_share.html">target_market_share</a></span>(</span>
<span id="cb13-3"><a href="#cb13-3"></a>    <span class="dt">ald =</span> ald_demo, </span>
<span id="cb13-4"><a href="#cb13-4"></a>    <span class="dt">scenario =</span> scenario_demo_<span class="dv">2020</span>,</span>
<span id="cb13-5"><a href="#cb13-5"></a>    <span class="dt">region_isos =</span> region_isos_demo,</span>
<span id="cb13-6"><a href="#cb13-6"></a>    <span class="dt">by_company =</span> <span class="ot">TRUE</span> <span class="co"># setting this flag will output results at company-level</span></span>
<span id="cb13-7"><a href="#cb13-7"></a>    )</span>
<span id="cb13-8"><a href="#cb13-8"></a></span>
<span id="cb13-9"><a href="#cb13-9"></a>market_share_targets_portfolio <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 x 7
##   sector technology  year region scenario_source weighted_produc…
##   &lt;chr&gt;  &lt;chr&gt;      &lt;int&gt; &lt;chr&gt;  &lt;chr&gt;           &lt;chr&gt;           
## 1 autom… electric    2020 global demo_2020       projected       
## 2 autom… electric    2020 global demo_2020       normalized_corp…
## 3 autom… electric    2020 global demo_2020       target_cps      
## 4 autom… electric    2020 global demo_2020       target_sds      
## 5 autom… electric    2020 global demo_2020       target_sps      
## 6 autom… hybrid      2020 global demo_2020       projected       
## # … with 1 more variable: weighted_production_value &lt;dbl&gt;</code></pre>
</div>
<div id="sectoral-decarbonization-approach" class="section level3">
<h3 class="hasAnchor">
<a href="#sectoral-decarbonization-approach" class="anchor"></a>Sectoral Decarbonization Approach</h3>
<p>The <a href="articles/target-market-share.html">Sectoral Decarbonization Approach</a> is used to calculate scenario targets for the <code>emission_factor</code> of a sector. For example, we can use this approach to set targets for the average emission factor of the cement sector. This approach is recommended for sectors lacking technology roadmaps.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>sda_targets &lt;-<span class="st"> </span>matched <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="st">  </span><span class="kw"><a href="../reference/target_sda.html">target_sda</a></span>(</span>
<span id="cb15-3"><a href="#cb15-3"></a>    <span class="dt">ald =</span> ald_demo, </span>
<span id="cb15-4"><a href="#cb15-4"></a>    <span class="dt">co2_intensity_scenario =</span> co2_intensity_scenario_demo</span>
<span id="cb15-5"><a href="#cb15-5"></a>    )</span>
<span id="cb15-6"><a href="#cb15-6"></a></span>
<span id="cb15-7"><a href="#cb15-7"></a>sda_targets <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>()</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
##   sector  year emission_factor_metric emission_factor_value
##   &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;                                  &lt;dbl&gt;
## 1 cement  2020 projected                              0.664
## 2 cement  2020 target                                 0.669
## 3 cement  2020 scenario_benchmark                     0.7  
## 4 cement  2021 projected                              0.665
## 5 cement  2021 target                                 0.612
## 6 cement  2021 scenario_benchmark                     0.64</code></pre>
</div>
</div>
<div id="visualization" class="section level2">
<h2 class="hasAnchor">
<a href="#visualization" class="anchor"></a>Visualization</h2>
<p>There are a large variety of possible visualizations stemming from the outputs of <code><a href="../reference/target_market_share.html">target_market_share()</a></code> and <code><a href="../reference/target_sda.html">target_sda()</a></code>. We will highlight a couple of common plots.</p>
<div id="market-share-sector-level-technology-mix" class="section level3">
<h3 class="hasAnchor">
<a href="#market-share-sector-level-technology-mix" class="anchor"></a>Market Share: Sector-level technology mix</h3>
<p>From the market share output, you can plot the portfolio’s exposure to various climate sensitive technologies (<code>projected</code>), and compare with various scenario targets.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>market_share_targets_portfolio <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(sector <span class="op">==</span><span class="st"> "power"</span>,</span>
<span id="cb17-3"><a href="#cb17-3"></a>         weighted_production_metric <span class="op">!=</span><span class="st"> "normalized_corporate_economy"</span>,</span>
<span id="cb17-4"><a href="#cb17-4"></a>         year <span class="op">==</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(year)) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># different targets can be plotted by setting these filters</span></span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(technology) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb17-6"><a href="#cb17-6"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> weighted_production_metric, <span class="dt">y =</span> weighted_production_value, <span class="dt">fill =</span></span>
<span id="cb17-7"><a href="#cb17-7"></a>               technology)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb17-8"><a href="#cb17-8"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span>(<span class="dt">position =</span> <span class="st">"fill"</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb17-9"><a href="#cb17-9"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span>(<span class="dt">x =</span> <span class="st">"Metric"</span>, </span>
<span id="cb17-10"><a href="#cb17-10"></a>       <span class="dt">y =</span> <span class="st">"Weighted Capacity [%]"</span>)</span></code></pre></div>
<p><img src="r2dii-analysis_files/figure-html/technoloy%20mix%20portfolio-1.png" width="700"></p>
<div id="market-share-technology-level-volume-trajectory" class="section level4">
<h4 class="hasAnchor">
<a href="#market-share-technology-level-volume-trajectory" class="anchor"></a>Market Share: Technology-level volume trajectory</h4>
<p>You can also plot the technology-specific volume trend. All targets and benchmarks are normalized to the initial portfolio value, so we are effectively comparing ambition.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>renewables_data &lt;-<span class="st"> </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(market_share_targets_portfolio, </span>
<span id="cb18-2"><a href="#cb18-2"></a>                          sector <span class="op">==</span><span class="st"> "power"</span>,</span>
<span id="cb18-3"><a href="#cb18-3"></a>                          technology <span class="op">==</span><span class="st"> "renewablescap"</span>,</span>
<span id="cb18-4"><a href="#cb18-4"></a>                          region <span class="op">==</span><span class="st"> "global"</span>)</span>
<span id="cb18-5"><a href="#cb18-5"></a></span>
<span id="cb18-6"><a href="#cb18-6"></a>just_targets &lt;-<span class="st"> </span>renewables_data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-7"><a href="#cb18-7"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"target_"</span>,weighted_production_metric))</span>
<span id="cb18-8"><a href="#cb18-8"></a></span>
<span id="cb18-9"><a href="#cb18-9"></a>ceiling &lt;-<span class="st"> </span>just_targets <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-10"><a href="#cb18-10"></a><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(sector, technology, year, region, scenario_source) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-11"><a href="#cb18-11"></a><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span>(<span class="dt">weighted_production_metric =</span> <span class="st">"target_ceiling"</span>,</span>
<span id="cb18-12"><a href="#cb18-12"></a>            <span class="dt">weighted_production_value =</span> <span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(weighted_production_value)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb18-13"><a href="#cb18-13"></a><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(sector, technology, region, scenario_source) <span class="op">%&gt;%</span><span class="st">  </span></span>
<span id="cb18-14"><a href="#cb18-14"></a><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="dt">weighted_production_value =</span> <span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(weighted_production_value))</span></code></pre></div>
<pre><code>## `summarise()` regrouping output by 'sector', 'technology', 'year', 'region' (override with `.groups` argument)</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>just_data &lt;-<span class="st"> </span>renewables_data <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/grep.html">grepl</a></span>(<span class="st">"target_"</span>,weighted_production_metric))</span>
<span id="cb20-3"><a href="#cb20-3"></a></span>
<span id="cb20-4"><a href="#cb20-4"></a>just_targets <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="st">  </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(ceiling) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb20-6"><a href="#cb20-6"></a><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(year) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb20-7"><a href="#cb20-7"></a><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(year, weighted_production_value) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb20-8"><a href="#cb20-8"></a><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(</span>
<span id="cb20-9"><a href="#cb20-9"></a>    <span class="dt">previous_value =</span> <span class="kw"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html">lag</a></span>(weighted_production_value, <span class="dt">default =</span> <span class="dv">0</span>),</span>
<span id="cb20-10"><a href="#cb20-10"></a>  ) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb20-11"><a href="#cb20-11"></a><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(region <span class="op">==</span><span class="st"> "global"</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb20-12"><a href="#cb20-12"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> year, </span>
<span id="cb20-13"><a href="#cb20-13"></a>             <span class="dt">y =</span> weighted_production_value, </span>
<span id="cb20-14"><a href="#cb20-14"></a>             <span class="dt">fill =</span> weighted_production_metric)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb20-15"><a href="#cb20-15"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html">geom_ribbon</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">ymin =</span> previous_value, <span class="dt">ymax =</span> weighted_production_value)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb20-16"><a href="#cb20-16"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>(<span class="dt">data =</span> just_data, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> year, </span>
<span id="cb20-17"><a href="#cb20-17"></a>                                  <span class="dt">y =</span> weighted_production_value, </span>
<span id="cb20-18"><a href="#cb20-18"></a>                                  <span class="dt">linetype =</span> weighted_production_metric)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb20-19"><a href="#cb20-19"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span>(sector, technology))</span></code></pre></div>
<p><img src="r2dii-analysis_files/figure-html/volume%20portfolio-1.png" width="700"></p>
</div>
</div>
<div id="sda-target" class="section level3">
<h3 class="hasAnchor">
<a href="#sda-target" class="anchor"></a>SDA Target</h3>
<p>From the SDA output, we can compare the projected average emission intensity attributed to the portfolio, with the actual emission intensity scenario, and the scenario compliant SDA pathway that the portfolio must follow to achieve the scenario ambition by 2050.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>sda_targets <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="st">  </span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(emission_factor_metric) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> year, <span class="dt">y =</span> emission_factor_value, <span class="dt">color =</span> emission_factor_metric)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb21-4"><a href="#cb21-4"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb21-5"><a href="#cb21-5"></a><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/vars.html">vars</a></span>(sector))</span></code></pre></div>
<p><img src="r2dii-analysis_files/figure-html/sda%20plot-1.png" width="700"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#load-your-r2dii-libraries">Load your r2dii libraries</a></li>
      <li><a href="#match-your-loanbook-to-climate-related-asset-level-data">Match your loanbook to climate-related asset-level data</a></li>
      <li><a href="#calculate-targets">Calculate targets</a></li>
      <li><a href="#visualization">Visualization</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://github.com/jdhoffa/">Jackson Hoffart</a>, <a href="https://github.com/maurolepore/">Mauro Lepore</a>, Klaus Hogedorn, <a href="https://2degrees-investing.org/">2 Degrees Investing Initiative</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
