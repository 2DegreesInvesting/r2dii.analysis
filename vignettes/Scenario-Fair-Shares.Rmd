---
title: "Scenario Fair Shares"
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(r2dii.dataraw)
library(r2dii.analysis)
```

## Scenario Fair Shares

Scenario efforts must be allocated to the portfolio's production profile. To do this, two principals are currently implemented:

1. Technology Fair Share:

$$p_{i}^{tfsr}(t) = p_{i}(t_0) * \dfrac{s_i(t)}{s_i(t_0)}$$

where:

* $s_i(t)$ is the scenario production for technology $i$ at time $t$,
* $p_{i,j}(t_0)$ is the production allocated to the portfolio for some technology, $i$ at time $t_0$, and
* $p_{i,j}^{tfsr}(t)$ is the portfolio-specific target production for that technology.

We define the "Technology Fair Share Ratio" as:

$$\dfrac{s_i(t)}{s_i(t_0)}$$

2. Market Fair Share:

$$p_{i,j}^{mfsp}(t) = p_{i,j}(t_0) +P_i(t_0) * \left( \dfrac{s_j(t)-s_j(t_0)}{S(t_0)}\right)$$
where:

* $P_i(t_0)$ is the portfolio's total production in the sector at $t_0$, and
* $S(t_0)$ is the scenario total production at $t_0$.

We define the "Market Fair Share Percentage" as:

$$\dfrac{s_j(t)-s_j(t_0)}{S(t_0)}$$

## Calculation

These fair shares can be calculated for an arbitrary scenario using:

```{r}
add_scenario_fair_shares(scenario_demo, start_year = 2020)
```
